function [ dPHI ] = Calculate_dPHI( x1,x2,x3,x4)
%% Configuration

% This is to calculate dPhi matrix (partial derivative of the action vation function)

% Four different kernel function£º 
% 1.dPhi_0 ---129 activation functions --- V129 --- Equa(29)
% 2.dPhi_1 ---84  activation functions --- V84 ---  Page 14 
% 3.dPhi_2 ---34  activation functions --- V34 ---  Page 14
% 4.dPhi_3 ---14  activation functions --- V14 ---  Page 14

% ** Please choose one kernel function before run the code**
% ** The default kernel function is V129 **

% By: Steven SU

%% dPhi_0 129dPHI
	dPHI=[ 	 2*x1            0               0               0
                x2              x1              0               0
                x3              0               x1              0
                x4              0               0               x1              
                0               2*x2            0               0                
                0               x3              x2              0
                0               x4              0               x2
                0               0               2*x3            0                
                0               0               x4              x3
                0               0               0               2*x4
                
                4*x1^3          0               0               0
                3*x1^2*x2       x1^3            0               0
                3*x1^2*x3       0               x1^3            0
                3*x1^2*x4       0               0               x1^3
                2*x1*x2^2       2*x1^2*x2       0               0
                2*x1*x2*x3      x1^2*x3         x1^2*x2         0
                2*x1*x2*x4      x1^2*x4         0               x1^2*x2
                2*x1*x3^2       0               2*x1^2*x3       0
                2*x1*x3*x4      0               x1^2*x4         x1^2*x3
                2*x1*x4^2       0               0               2*x1^2*x4
                x2^3            3*x1*x2^2       0               0
                x2^2*x3         2*x1*x2*x3      x1*x2^2         0
                x2^2*x4         2*x1*x2*x4      0               x1*x2^2
                x2*x3^2         x1*x3^2         2*x1*x2*x3      0
                x2*x3*x4        x1*x3*x4        x1*x2*x4        x1*x2*x3
                x2*x4^2         x1*x4^2         0               2*x1*x2*x4
                x3^3            0               3*x1*x3^2       0
                x3^2*x4         0               2*x1*x3*x4      x1*x3^2
                x3*x4^2         0               x1*x4^2         2*x1*x3*x4
                x4^3            0               0               3*x1*x4^2
                0               4*x2^3          0               0
                0               3*x2^2*x3       x2^3            0
                0               3*x2^2*x4       0               x2^3
                0               2*x2*x3^2       2*x2^2*x3       0
                0               2*x2*x3*x4      x2^2*x4         x2^2*x3
                0               2*x2*x4^2       0               2*x2^2*x4
                0               x3^3            3*x2*x3^2       0
                0               x3^2*x4         2*x2*x3*x4      x2*x3^2
                0               x3*x4^2         x2*x4^2         2*x2*x3*x4
                0               x4^3            0               3*x2*x4^2
                0               0               4*x3^3          0
                0               0               3*x3^2*x4       x3^3
                0               0               2*x3*x4^2       2*x3^2*x4
                0               0               x4^3            3*x3*x4^2
                0               0               0               4*x4^3
                
                6*x1^5          0               0               0
                5*x1^4*x2       x1^5            0               0
                5*x1^4*x3       0               x1^5            0
                5*x1^4*x4       0               0               x1^5
                4*x1^3*x2^2     2*x1^4*x2       0               0
                4*x1^3*x2*x3    x1^4*x3         x1^4*x2         0
                4*x1^3*x2*x4    x1^4*x4         0               x1^4*x2
                4*x1^3*x3^2     0               2*x1^4*x3       0
                4*x1^3*x3*x4    0               x1^4*x4         x1^4*x3
                4*x1^3*x4^2     0               0               2*x1^4*x4
                3*x1^2*x2^3     3*x1^3*x2^2     0               0
                3*x1^2*x2^2*x3  2*x1^3*x2*x3    x1^3*x2^2       0
                3*x1^2*x2^2*x4  2*x1^3*x2*x4    0               x1^3*x2^2
                3*x1^2*x2*x3^2  x1^3*x3^2       2*x1^3*x2*x3    0
                3*x1^2*x2*x3*x4 x1^3*x3*x4      x1^3*x2*x4      x1^3*x2*x3
                3*x1^2*x2*x4^2  x1^3*x4^2       0               2*x1^3*x2*x4
                3*x1^2*x3^3     0               3*x1^3*x3^2     0
                3*x1^2*x3^2*x4  0               2*x1^3*x3*x4    x1^3*x3^2
                3*x1^2*x3*x4^2  0               x1^3*x4^2       2*x1^3*x3*x4
                3*x1^2*x4^3     0               0               3*x1^3*x4^2
                2*x1*x2^4       4*x1^2*x2^3     0               0
                2*x1*x2^3*x3    3*x1^2*x2^2*x3  x1^2*x2^3       0
                2*x1*x2^3*x4    3*x1^2*x2^2*x4  0               x1^2*x2^3
                2*x1*x2^2*x3^2  2*x1^2*x2*x3^2  2*x1^2*x2^2*x3  0
                2*x1*x2^2*x3*x4 2*x1^2*x2*x3*x4 x1^2*x2^2*x4    x1^2*x2^2*x3
                2*x1*x2^2*x4^2  2*x1^2*x2*x4^2  0               2*x1^2*x2^2*x4
                2*x1*x2*x3^3    x1^2*x3^3       3*x1^2*x2*x3^2  0
                2*x1*x2*x3^2*x4 x1^2*x3^2*x4    2*x1^2*x2*x3*x4 x1^2*x2*x3^2
                2*x1*x2*x3*x4^2 x1^2*x3*x4^2    x1^2*x2*x4^2    2*x1^2*x2*x3*x4
                2*x1*x2*x4^3    x1^2*x4^3       0               3*x1^2*x2*x4^2
                2*x1*x3^4       0               4*x1^2*x3^3     0
                2*x1*x3^3*x4    0               3*x1^2*x3^2*x4  x1^2*x3^3
                2*x1*x3^2*x4^2  0               2*x1^2*x3*x4^2  2*x1^2*x3^2*x4
                2*x1*x3*x4^3    0               x1^2*x4^3       3*x1^2*x3*x4^2
                2*x1*x4^4       0               0               4*x1^2*x4^3
                x2^5            5*x1*x2^4       0               0
                x2^4*x3         4*x1*x2^3*x3    x1*x2^4         0
                x2^4*x4         4*x1*x2^3*x4    0               x1*x2^4
                x2^3*x3^2       3*x1*x2^2*x3^2  2*x1*x2^3*x3    0
                x2^3*x3*x4      3*x1*x2^2*x3*x4 x1*x2^3*x4      x1*x2^3*x3
                x2^3*x4^2       3*x1*x2^2*x4^2  0               2*x1*x2^3*x4
                x2^2*x3^3       2*x1*x2*x3^3    3*x1*x2^2*x3^2  0
                x2^2*x3^2*x4    2*x1*x2*x3^2*x4 2*x1*x2^2*x3*x4 x1*x2^2*x3^2
                x2^2*x3*x4^2    2*x1*x2*x3*x4^2 x1*x2^2*x4^2    2*x1*x2^2*x3*x4
                x2^2*x4^3       2*x1*x2*x4^3    0               3*x1*x2^2*x4^2
                x2*x3^4         x1*x3^4         4*x1*x2*x3^3    0
                x2*x3^3*x4      x1*x3^3*x4      3*x1*x2*x3^2*x4 x1*x2*x3^3
                x2*x3^2*x4^2    x1*x3^2*x4^2    2*x1*x2*x3*x4^2 2*x1*x2*x3^2*x4
                x2*x3*x4^3      x1*x3*x4^3      x1*x2*x4^3      3*x1*x2*x3*x4^2
                x2*x4^4         x1*x4^4         0               4*x1*x2*x4^3
                x3^5            0               5*x1*x3^4       0
                x3^4*x4         0               4*x1*x3^3*x4    x1*x3^4
                x3^3*x4^2       0               3*x1*x3^2*x4^2  2*x1*x3^3*x4
                x3^2*x4^3       0               2*x1*x3*x4^3    3*x1*x3^2*x4^2
                x3*x4^4         0               x1*x4^4         4*x1*x3*x4^3
                x4^5            0               0               5*x1*x4^4
                0               6*x2^5          0               0
                0               5*x2^4*x3       x2^5            0
                0               5*x2^4*x4       0               x2^5
                0               4*x2^3*x3^2     2*x2^4*x3       0
                0               4*x2^3*x3*x4    x2^4*x4         x2^4*x3
                0               4*x2^3*x4^2     0               2*x2^4*x4
                0               3*x2^2*x3^3     3*x2^3*x3^2     0
                0               3*x2^2*x3^2*x4  2*x2^3*x3*x4    x2^3*x3^2
                0               3*x2^2*x3*x4^2  x2^3*x4^2       2*x2^3*x3*x4
                0               3*x2^2*x4^3     0               3*x2^3*x4^2
                0               2*x2*x3^4       4*x2^2*x3^3     0
                0               2*x2*x3^3*x4    3*x2^2*x3^2*x4  x2^2*x3^3
                0               2*x2*x3^2*x4^2  2*x2^2*x3*x4^2  2*x2^2*x3^2*x4
                0               2*x2*x3*x4^3    x2^2*x4^3       3*x2^2*x3*x4^2
                0               2*x2*x4^4       0               4*x2^2*x4^3
                0               x3^5            5*x2*x3^4       0
                0               x3^4*x4         4*x2*x3^3*x4    x2*x3^4
                0               x3^3*x4^2       3*x2*x3^2*x4^2  2*x2*x3^3*x4
                0               x3^2*x4^3       2*x2*x3*x4^3    3*x2*x3^2*x4^2
                0               x3*x4^4         x2*x4^4         4*x2*x3*x4^3
                0               x4^5            0               5*x2*x4^4
                0               0               6*x3^5          0
                0               0               5*x3^4*x4       x3^5
                0               0               4*x3^3*x4^2     2*x3^4*x4
                0               0               3*x3^2*x4^3     3*x3^3*x4^2
                0               0               2*x3*x4^4       4*x3^2*x4^3
                0               0               x4^5            5*x3*x4^4
                0               0               0               6*x4^5	];

%% dPhi_1  Power to six, 84 polinomials,V84

%   dPHI=[ 	
%                 6*x1^5          0               0               0
%                 5*x1^4*x2       x1^5            0               0
%                 5*x1^4*x3       0               x1^5            0
%                 5*x1^4*x4       0               0               x1^5
%                 4*x1^3*x2^2     2*x1^4*x2       0               0
%                 4*x1^3*x2*x3    x1^4*x3         x1^4*x2         0
%                 4*x1^3*x2*x4    x1^4*x4         0               x1^4*x2
%                 4*x1^3*x3^2     0               2*x1^4*x3       0
%                 4*x1^3*x3*x4    0               x1^4*x4         x1^4*x3
%                 4*x1^3*x4^2     0               0               2*x1^4*x4
%                 3*x1^2*x2^3     3*x1^3*x2^2     0               0
%                 3*x1^2*x2^2*x3  2*x1^3*x2*x3    x1^3*x2^2       0
%                 3*x1^2*x2^2*x4  2*x1^3*x2*x4    0               x1^3*x2^2
%                 3*x1^2*x2*x3^2  x1^3*x3^2       2*x1^3*x2*x3    0
%                 3*x1^2*x2*x3*x4 x1^3*x3*x4      x1^3*x2*x4      x1^3*x2*x3
%                 3*x1^2*x2*x4^2  x1^3*x4^2       0               2*x1^3*x2*x4
%                 3*x1^2*x3^3     0               3*x1^3*x3^2     0
%                 3*x1^2*x3^2*x4  0               2*x1^3*x3*x4    x1^3*x3^2
%                 3*x1^2*x3*x4^2  0               x1^3*x4^2       2*x1^3*x3*x4
%                 3*x1^2*x4^3     0               0               3*x1^3*x4^2
%                 2*x1*x2^4       4*x1^2*x2^3     0               0
%                 2*x1*x2^3*x3    3*x1^2*x2^2*x3  x1^2*x2^3       0
%                 2*x1*x2^3*x4    3*x1^2*x2^2*x4  0               x1^2*x2^3
%                 2*x1*x2^2*x3^2  2*x1^2*x2*x3^2  2*x1^2*x2^2*x3  0
%                 2*x1*x2^2*x3*x4 2*x1^2*x2*x3*x4 x1^2*x2^2*x4    x1^2*x2^2*x3
%                 2*x1*x2^2*x4^2  2*x1^2*x2*x4^2  0               2*x1^2*x2^2*x4
%                 2*x1*x2*x3^3    x1^2*x3^3       3*x1^2*x2*x3^2  0
%                 2*x1*x2*x3^2*x4 x1^2*x3^2*x4    2*x1^2*x2*x3*x4 x1^2*x2*x3^2
%                 2*x1*x2*x3*x4^2 x1^2*x3*x4^2    x1^2*x2*x4^2    2*x1^2*x2*x3*x4
%                 2*x1*x2*x4^3    x1^2*x4^3       0               3*x1^2*x2*x4^2
%                 2*x1*x3^4       0               4*x1^2*x3^3     0
%                 2*x1*x3^3*x4    0               3*x1^2*x3^2*x4  x1^2*x3^3
%                 2*x1*x3^2*x4^2  0               2*x1^2*x3*x4^2  2*x1^2*x3^2*x4
%                 2*x1*x3*x4^3    0               x1^2*x4^3       3*x1^2*x3*x4^2
%                 2*x1*x4^4       0               0               4*x1^2*x4^3
%                 x2^5            5*x1*x2^4       0               0
%                 x2^4*x3         4*x1*x2^3*x3    x1*x2^4         0
%                 x2^4*x4         4*x1*x2^3*x4    0               x1*x2^4
%                 x2^3*x3^2       3*x1*x2^2*x3^2  2*x1*x2^3*x3    0
%                 x2^3*x3*x4      3*x1*x2^2*x3*x4 x1*x2^3*x4      x1*x2^3*x3
%                 x2^3*x4^2       3*x1*x2^2*x4^2  0               2*x1*x2^3*x4
%                 x2^2*x3^3       2*x1*x2*x3^3    3*x1*x2^2*x3^2  0
%                 x2^2*x3^2*x4    2*x1*x2*x3^2*x4 2*x1*x2^2*x3*x4 x1*x2^2*x3^2
%                 x2^2*x3*x4^2    2*x1*x2*x3*x4^2 x1*x2^2*x4^2    2*x1*x2^2*x3*x4
%                 x2^2*x4^3       2*x1*x2*x4^3    0               3*x1*x2^2*x4^2
%                 x2*x3^4         x1*x3^4         4*x1*x2*x3^3    0
%                 x2*x3^3*x4      x1*x3^3*x4      3*x1*x2*x3^2*x4 x1*x2*x3^3
%                 x2*x3^2*x4^2    x1*x3^2*x4^2    2*x1*x2*x3*x4^2 2*x1*x2*x3^2*x4
%                 x2*x3*x4^3      x1*x3*x4^3      x1*x2*x4^3      3*x1*x2*x3*x4^2
%                 x2*x4^4         x1*x4^4         0               4*x1*x2*x4^3
%                 x3^5            0               5*x1*x3^4       0
%                 x3^4*x4         0               4*x1*x3^3*x4    x1*x3^4
%                 x3^3*x4^2       0               3*x1*x3^2*x4^2  2*x1*x3^3*x4
%                 x3^2*x4^3       0               2*x1*x3*x4^3    3*x1*x3^2*x4^2
%                 x3*x4^4         0               x1*x4^4         4*x1*x3*x4^3
%                 x4^5            0               0               5*x1*x4^4
%                 0               6*x2^5          0               0
%                 0               5*x2^4*x3       x2^5            0
%                 0               5*x2^4*x4       0               x2^5
%                 0               4*x2^3*x3^2     2*x2^4*x3       0
%                 0               4*x2^3*x3*x4    x2^4*x4         x2^4*x3
%                 0               4*x2^3*x4^2     0               2*x2^4*x4
%                 0               3*x2^2*x3^3     3*x2^3*x3^2     0
%                 0               3*x2^2*x3^2*x4  2*x2^3*x3*x4    x2^3*x3^2
%                 0               3*x2^2*x3*x4^2  x2^3*x4^2       2*x2^3*x3*x4
%                 0               3*x2^2*x4^3     0               3*x2^3*x4^2
%                 0               2*x2*x3^4       4*x2^2*x3^3     0
%                 0               2*x2*x3^3*x4    3*x2^2*x3^2*x4  x2^2*x3^3
%                 0               2*x2*x3^2*x4^2  2*x2^2*x3*x4^2  2*x2^2*x3^2*x4
%                 0               2*x2*x3*x4^3    x2^2*x4^3       3*x2^2*x3*x4^2
%                 0               2*x2*x4^4       0               4*x2^2*x4^3
%                 0               x3^5            5*x2*x3^4       0
%                 0               x3^4*x4         4*x2*x3^3*x4    x2*x3^4
%                 0               x3^3*x4^2       3*x2*x3^2*x4^2  2*x2*x3^3*x4
%                 0               x3^2*x4^3       2*x2*x3*x4^3    3*x2*x3^2*x4^2
%                 0               x3*x4^4         x2*x4^4         4*x2*x3*x4^3
%                 0               x4^5            0               5*x2*x4^4
%                 0               0               6*x3^5          0
%                 0               0               5*x3^4*x4       x3^5
%                 0               0               4*x3^3*x4^2     2*x3^4*x4
%                 0               0               3*x3^2*x4^3     3*x3^3*x4^2
%                 0               0               2*x3*x4^4       4*x3^2*x4^3
%                 0               0               x4^5            5*x3*x4^4
%                 0               0               0               6*x4^5	];

            %% dPhi _2   Power of 6 , only any 2 of 4   ,34 Polinomials V34
%   dPHI=[ 	
%                 6*x1^5          0               0               0
%                 5*x1^4*x2       x1^5            0               0
%                 5*x1^4*x3       0               x1^5            0
%                 5*x1^4*x4       0               0               x1^5
%                 4*x1^3*x2^2     2*x1^4*x2       0               0
%                 4*x1^3*x3^2     0               2*x1^4*x3       0
%                 4*x1^3*x4^2     0               0               2*x1^4*x4
%                 3*x1^2*x2^3     3*x1^3*x2^2     0               0
%                 3*x1^2*x3^3     0               3*x1^3*x3^2     0
%                 3*x1^2*x4^3     0               0               3*x1^3*x4^2
%                 2*x1*x2^4       4*x1^2*x2^3     0               0
%                 2*x1*x3^4       0               4*x1^2*x3^3     0
%                 2*x1*x4^4       0               0               4*x1^2*x4^3
%                 x2^5            5*x1*x2^4       0               0
%                 x3^5            0               5*x1*x3^4       0
%                 x4^5            0               0               5*x1*x4^4
%                 0               6*x2^5          0               0
%                 0               5*x2^4*x3       x2^5            0
%                 0               5*x2^4*x4       0               x2^5
%                 0               4*x2^3*x3^2     2*x2^4*x3       0
%                 0               4*x2^3*x4^2     0               2*x2^4*x4
%                 0               3*x2^2*x3^3     3*x2^3*x3^2     0
%                 0               3*x2^2*x4^3     0               3*x2^3*x4^2
%                 0               2*x2*x3^4       4*x2^2*x3^3     0
%                 0               2*x2*x4^4       0               4*x2^2*x4^3
%                 0               x3^5            5*x2*x3^4       0
%                 0               x4^5            0               5*x2*x4^4
%                 0               0               6*x3^5          0
%                 0               0               5*x3^4*x4       x3^5
%                 0               0               4*x3^3*x4^2     2*x3^4*x4
%                 0               0               3*x3^2*x4^3     3*x3^3*x4^2
%                 0               0               2*x3*x4^4       4*x3^2*x4^3
%                 0               0               x4^5            5*x3*x4^4
%                 0               0               0               6*x4^5	];
            


%%  dPhi _3   Power of 6 ,14 polinomials V14
%               dPHI=[ 	
%                 6*x1^5          0               0               0
%                 5*x1^4*x2       x1^5            0               0
%                 4*x1^3*x2^2     2*x1^4*x2       0               0
%                 3*x1^2*x2^3     3*x1^3*x2^2     0               0
%                 2*x1*x2^4       4*x1^2*x2^3     0               0
%                 x2^5            5*x1*x2^4       0               0
%                 0               6*x2^5          0               0
%                 0               0               6*x3^5          0
%                 0               0               5*x3^4*x4       x3^5
%                 0               0               4*x3^3*x4^2     2*x3^4*x4
%                 0               0               3*x3^2*x4^3     3*x3^3*x4^2
%                 0               0               2*x3*x4^4       4*x3^2*x4^3
%                 0               0               x4^5            5*x3*x4^4
%                 0               0               0               6*x4^5	];


end

